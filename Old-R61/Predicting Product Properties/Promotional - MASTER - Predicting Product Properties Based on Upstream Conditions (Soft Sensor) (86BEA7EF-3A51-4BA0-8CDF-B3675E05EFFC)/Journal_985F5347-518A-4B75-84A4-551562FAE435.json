{
    "Definition": {
        "Archived": false,
        "Cache Enabled": false,
        "Created At": "1552581298253000000",
        "Description": "This worksheet uses Seeq tools to calculate and display product specification limits for the Product Viscosity as boundaries. Display Starting Point Boundary Signals to be created: Viscosity Quality Specification Limits Grade Transition Condition Boundaries Creating Quality Specification Limits A tag does not exist for the upper and lower specification limit",
        "Document": "<h3><strong>Creating Boundaries:</strong></h3><p>This worksheet uses Seeq tools to calculate and display product specification limits for the Product Viscosity as boundaries.</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;2D63C4D9-1D91-47FD-AED3-552A2A16B70E\" rel=\"nofollow noopener noreferrer\">Display Starting Point</a></h4><p><strong>Boundary Signals to be created:</strong></p><ul><li>Viscosity Quality Specification Limits</li><li>Grade Transition Condition Boundaries</li></ul><p><strong>Creating Quality Specification Limits</strong></p><p>A tag does not exist for the upper and lower specification limit signals, so a signal had to be created.</p><p>1. Add the signal &#34;Grade_Code_with_Forecast&#34; back to the display pane. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43DD66CB-F12B-4EF0-8859-6A0055FBAD74\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>2. Create a Condition for each Product Grade using Value Search. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3C5392D8-6D5C-4E34-8BF1-CFBD50671912\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>3. Use Formula and the Splice function to create a new signal for the upper and lower specification limits for Product Viscosity across all grades. Below is an example of how Formula is used to create these signals.\u00a0</p><pre><code>$USL101 &#61; (1.1).tosignal()\n$USL102 &#61; (0.88).tosignal()\n$USL103 &#61; (1.21).tosignal()\n$USL104 &#61; (0.825).tosignal()\n$USL105 &#61; (0.99).tosignal()\n$USL106 &#61; (0.594).tosignal()\n$USL107 &#61; (1.155).tosignal()\n$USL108 &#61; (1.87).tosignal()\n\n$USL101\n\u00a0 \u00a0 \u00a0.splice($USL102,$GR102,False)\n\u00a0 \u00a0 \u00a0.splice($USL103,$GR103, False)\n\u00a0 \u00a0 \u00a0.splice($USL104,$GR104, False)\n\u00a0 \u00a0 \u00a0.splice($USL105,$GR105, False)\n\u00a0 \u00a0 \u00a0.splice($USL106,$GR106, False)\n\u00a0 \u00a0 \u00a0.splice($USL107,$GR107, False)\n\u00a0 \u00a0 \u00a0.splice($USL108,$GR108, False)</code></pre><ul><li>Upper Specification Limit \u00a0(<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;22CA211F-A984-48D2-8204-214C65AFAEEE\" rel=\"nofollow noopener noreferrer\">work step</a>)</li><li>Lower Specification Limit (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;D0E0F9F6-7727-4F0A-B5AE-21A29E517798\" rel=\"nofollow noopener noreferrer\">work step</a>)</li></ul><p>4. Use the Boundaries tool to turn the USL and LSL into boundaries on the signal &#34;Product_Viscosity&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;EE4C97C8-3C1D-4B65-9C03-999F262028B1\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>5. Create a signal for the Target Viscosity (Central between the USL and LSL). This can be done via the same splice methodology in formula, or by taking the average of the USL and LSL signals. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C3B29D21-FAD2-4EF3-9DC3-6FF080FFB33C\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre><code>$LSL.add($USL).divide(2)</code></pre><p><strong>Creating Boundaries during Grade Transitions</strong></p><p>We want to expand our upper and lower boundaries on the viscosity signal horizontally to encapsulate time periods when we are transitioning between product grades. To create a condition for &#34;Grade Transition&#34;:</p><p>1. Use formula to create a new combined condition for all grades that also assigns the value of the signal grade code to a property of the signal called &#34;Value&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43D6561B-E8EA-4E20-80C6-F375D49A0647\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre><code>$gradeCode.tostring().toCapsules(1wk)</code></pre><p><em>Add the property &#34;value&#34; to the capsules pane to view the grade of each of the new capsules.\u00a0</em>\u00a0</p><p>2. Use formula and the afterstart() and move functions to create a new condition called &#34;Grade Transitions&#34; that includes 0.5 hours before the start of the &#34;All Grades (with Property)&#34; capsules and 2.5 hours following the start of each of the &#34;All Grades (with Property)&#34; capsules. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3E0880B4-6A08-4BF2-B1C5-890EEB133B92\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre><code>$allGrades.afterStart(3h).move(-0.5h)</code></pre><p>2. Calculate the maximum and minimum limits to be applied to create boundaries during the &#34;grade transition&#34; capsules. The following code takes the minimum of the LSL signal during the condition &#34;Transition&#34; and creates a new signal with that value over the duration of the condition. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C69B22AC-61AA-4931-B7FD-6C6E73940BB6\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre><code>$LSL.aggregate(minvalue(),$Transition,durationkey())</code></pre><p>3. Use the Boundaries tool to create a new boundary on the Product_Viscosity signal over the condition &#34;Grade Transition Capsules.&#34; (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;90EBF834-6CDF-46FB-A600-7483E9F9996B\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;484049F3-AA2E-4E89-9D53-49AF4272A071\" rel=\"nofollow noopener noreferrer\">Display Final View</a></h4>",
        "DocumentBackup\u02c9B3BHbCR7txjEswHoBi2qQdHId7cTbSw2C65s2u7PTOU\u02c92021-07-20T11:50:00Z": "<h3><strong>Creating Boundaries:</strong></h3><p>This worksheet uses Seeq tools to calculate and display product specification limits for the Product Viscosity as boundaries.</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;2D63C4D9-1D91-47FD-AED3-552A2A16B70E\" rel=\"nofollow noopener noreferrer\">Display Starting Point</a></h4><p><strong>Boundary Signals to be created:</strong></p><ul><li>Viscosity Quality Specification Limits</li><li>Grade Transition Condition Boundaries</li></ul><p><strong>Creating Quality Specification Limits</strong></p><p>A tag does not exist for the upper and lower specification limit signals, so a signal had to be created.</p><p>1. Add the signal &#34;Grade_Code_with_Forecast&#34; back to the display pane. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43DD66CB-F12B-4EF0-8859-6A0055FBAD74\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>2. Create a Condition for each Product Grade using Value Search. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3C5392D8-6D5C-4E34-8BF1-CFBD50671912\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>3. Use Formula and the Splice function to create a new signal for the upper and lower specification limits for Product Viscosity across all grades. Below is an example of how Formula is used to create these signals.\u00a0</p><pre>$USL101 &#61; (1.1).tosignal()\n$USL102 &#61; (0.88).tosignal()\n$USL103 &#61; (1.21).tosignal()\n$USL104 &#61; (0.825).tosignal()\n$USL105 &#61; (0.99).tosignal()\n$USL106 &#61; (0.594).tosignal()\n$USL107 &#61; (1.155).tosignal()\n$USL108 &#61; (1.87).tosignal()\n\n$USL101\n\u00a0 \u00a0 \u00a0.splice($USL102,$GR102,False)\n\u00a0 \u00a0 \u00a0.splice($USL103,$GR103, False)\n\u00a0 \u00a0 \u00a0.splice($USL104,$GR104, False)\n\u00a0 \u00a0 \u00a0.splice($USL105,$GR105, False)\n\u00a0 \u00a0 \u00a0.splice($USL106,$GR106, False)\n\u00a0 \u00a0 \u00a0.splice($USL107,$GR107, False)\n\u00a0 \u00a0 \u00a0.splice($USL108,$GR108, False)</pre><ul><li>Upper Specification Limit \u00a0(<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;22CA211F-A984-48D2-8204-214C65AFAEEE\" rel=\"nofollow noopener noreferrer\">work step</a>)</li><li>Lower Specification Limit (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;D0E0F9F6-7727-4F0A-B5AE-21A29E517798\" rel=\"nofollow noopener noreferrer\">work step</a>)</li></ul><p>4. Use the Boundaries tool to turn the USL and LSL into boundaries on the signal &#34;Product_Viscosity&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;EE4C97C8-3C1D-4B65-9C03-999F262028B1\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>5. Create a signal for the Target Viscosity (Central between the USL and LSL). This can be done via the same splice methodology in formula, or by taking the average of the USL and LSL signals. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C3B29D21-FAD2-4EF3-9DC3-6FF080FFB33C\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.add($USL).divide(2)</pre><p><strong>Creating Boundaries during Grade Transitions</strong></p><p>We want to expand our upper and lower boundaries on the viscosity signal horizontally to encapsulate time periods when we are transitioning between product grades. To create a condition for &#34;Grade Transition&#34;:</p><p>1. Use formula to create a new combined condition for all grades that also assigns the value of the signal grade code to a property of the signal called &#34;Value&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43D6561B-E8EA-4E20-80C6-F375D49A0647\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$gradeCode.tostring().toCapsules(1wk)</pre><p><em>Add the property &#34;value&#34; to the capsules pane to view the grade of each of the new capsules.\u00a0</em>\u00a0</p><p>2. Use formula and the afterstart() and move functions to create a new condition called &#34;Grade Transitions&#34; that includes 0.5 hours before the start of the &#34;All Grades (with Property)&#34; capsules and 2.5 hours following the start of each of the &#34;All Grades (with Property)&#34; capsules. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3E0880B4-6A08-4BF2-B1C5-890EEB133B92\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$allGrades.afterStart(3h).move(-0.5h)</pre><p>2. Calculate the maximum and minimum limits to be applied to create boundaries during the &#34;grade transition&#34; capsules. The following code takes the minimum of the LSL signal during the condition &#34;Transition&#34; and creates a new signal with that value over the duration of the condition. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C69B22AC-61AA-4931-B7FD-6C6E73940BB6\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.aggregate(minvalue(),$Transition,durationkey())</pre><p>3. Use the Boundaries tool to create a new boundary on the Product_Viscosity signal over the condition &#34;Grade Transition Capsules.&#34; (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;90EBF834-6CDF-46FB-A600-7483E9F9996B\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;484049F3-AA2E-4E89-9D53-49AF4272A071\" rel=\"nofollow noopener noreferrer\">Display Final View</a></h4>",
        "DocumentBackup\u02c9GvRKyOtBkUDimyrzS3NUVqGWN4HgYxxATZRqyHJtziU\u02c92021-07-20T11:50:00Z": "<h4>Links to Previous Worksheets:</h4><ul><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/17065A04-0E4E-4A0F-AAC4-BC78F3269FEF\" rel=\"nofollow noopener noreferrer\">Pulling in Process Data</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/E730749E-353A-4D99-9CEF-3E0AFB9D6981\" rel=\"nofollow noopener noreferrer\">Calculating new Delayed Reactor Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/BDE8A3B9-866D-4D5B-8740-D10350D4924A\" rel=\"nofollow noopener noreferrer\">Cleansing Model Input Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/271B44F1-6AFB-4E54-9700-25E1577FCDDA\" rel=\"nofollow noopener noreferrer\">Model Generation and Comparison</a></li></ul><h3><strong>Creating Boundaries:</strong></h3><p>This worksheet uses Seeq tools to calculate and display product specification limits for the Product Viscosity as boundaries.</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;2D63C4D9-1D91-47FD-AED3-552A2A16B70E\" rel=\"nofollow noopener noreferrer\">Display Starting Point</a></h4><p><strong>Boundary Signals to be created:</strong></p><ul><li>Viscosity Quality Specification Limits</li><li>Grade Transition Condition Boundaries</li></ul><p><strong>Creating Quality Specification Limits</strong></p><p>A tag does not exist for the upper and lower specification limit signals, so a signal had to be created.</p><p>1. Add the signal &#34;Grade_Code_with_Forecast&#34; back to the display pane. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43DD66CB-F12B-4EF0-8859-6A0055FBAD74\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>2. Create a Condition for each Product Grade using Value Search. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3C5392D8-6D5C-4E34-8BF1-CFBD50671912\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>3. Use Formula and the Splice function to create a new signal for the upper and lower specification limits for Product Viscosity across all grades. Below is an example of how Formula is used to create these signals.\u00a0</p><pre>$USL101 &#61; (1.1).tosignal()\n$USL102 &#61; (0.88).tosignal()\n$USL103 &#61; (1.21).tosignal()\n$USL104 &#61; (0.825).tosignal()\n$USL105 &#61; (0.99).tosignal()\n$USL106 &#61; (0.594).tosignal()\n$USL107 &#61; (1.155).tosignal()\n$USL108 &#61; (1.87).tosignal()\n\n$USL101\n\u00a0 \u00a0 \u00a0.splice($USL102,$GR102,False)\n\u00a0 \u00a0 \u00a0.splice($USL103,$GR103, False)\n\u00a0 \u00a0 \u00a0.splice($USL104,$GR104, False)\n\u00a0 \u00a0 \u00a0.splice($USL105,$GR105, False)\n\u00a0 \u00a0 \u00a0.splice($USL106,$GR106, False)\n\u00a0 \u00a0 \u00a0.splice($USL107,$GR107, False)\n\u00a0 \u00a0 \u00a0.splice($USL108,$GR108, False)</pre><ul><li>Upper Specification Limit \u00a0(<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;22CA211F-A984-48D2-8204-214C65AFAEEE\" rel=\"nofollow noopener noreferrer\">work step</a>)</li><li>Lower Specification Limit (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;D0E0F9F6-7727-4F0A-B5AE-21A29E517798\" rel=\"nofollow noopener noreferrer\">work step</a>)</li></ul><p>4. Use the Boundaries tool to turn the USL and LSL into boundaries on the signal &#34;Product_Viscosity&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;EE4C97C8-3C1D-4B65-9C03-999F262028B1\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>5. Create a signal for the Target Viscosity (Central between the USL and LSL). This can be done via the same splice methodology in formula, or by taking the average of the USL and LSL signals. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C3B29D21-FAD2-4EF3-9DC3-6FF080FFB33C\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.add($USL).divide(2)</pre><p><strong>Creating Boundaries during Grade Transitions</strong></p><p>We want to expand our upper and lower boundaries on the viscosity signal horizontally to encapsulate time periods when we are transitioning between product grades. To create a condition for &#34;Grade Transition&#34;:</p><p>1. Use formula to create a new combined condition for all grades that also assigns the value of the signal grade code to a property of the signal called &#34;Value&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43D6561B-E8EA-4E20-80C6-F375D49A0647\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$gradeCode.tostring().toCapsules(1wk)</pre><p><em>Add the property &#34;value&#34; to the capsules pane to view the grade of each of the new capsules.\u00a0</em>\u00a0</p><p>2. Use formula and the afterstart() and move functions to create a new condition called &#34;Grade Transitions&#34; that includes 0.5 hours before the start of the &#34;All Grades (with Property)&#34; capsules and 2.5 hours following the start of each of the &#34;All Grades (with Property)&#34; capsules. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3E0880B4-6A08-4BF2-B1C5-890EEB133B92\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$allGrades.afterStart(3h).move(-0.5h)</pre><p>2. Calculate the maximum and minimum limits to be applied to create boundaries during the &#34;grade transition&#34; capsules. The following code takes the minimum of the LSL signal during the condition &#34;Transition&#34; and creates a new signal with that value over the duration of the condition. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C69B22AC-61AA-4931-B7FD-6C6E73940BB6\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.aggregate(minvalue(),$Transition,durationkey())</pre><p>3. Use the Boundaries tool to create a new boundary on the Product_Viscosity signal over the condition &#34;Grade Transition Capsules.&#34; (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;90EBF834-6CDF-46FB-A600-7483E9F9996B\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;484049F3-AA2E-4E89-9D53-49AF4272A071\" rel=\"nofollow noopener noreferrer\">Display Final View</a></h4>",
        "DocumentBackup\u02c9allison.buenemann@seeq.com\u02c92019-06-17T20:32:00Z": "<h4>Links to Previous Worksheets:</h4><ul><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/17065A04-0E4E-4A0F-AAC4-BC78F3269FEF\" rel=\"nofollow noopener noreferrer\">Pulling in Process Data</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/E730749E-353A-4D99-9CEF-3E0AFB9D6981\" rel=\"nofollow noopener noreferrer\">Calculating new Delayed Reactor Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/BDE8A3B9-866D-4D5B-8740-D10350D4924A\" rel=\"nofollow noopener noreferrer\">Cleansing Model Input Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/271B44F1-6AFB-4E54-9700-25E1577FCDDA\" rel=\"nofollow noopener noreferrer\">Model Generation and Comparison</a></li></ul><h3><strong>Creating Boundaries:</strong></h3><p>This worksheet uses Seeq tools to calculate and display product specification limits for the Product Viscosity as boundaries.</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;2D63C4D9-1D91-47FD-AED3-552A2A16B70E\" rel=\"nofollow noopener noreferrer\">Display Starting Point</a></h4><p><strong>Boundary Signals to be created:</strong></p><ul><li>Viscosity Quality Specification Limits</li><li>Grade Transition Condition Boundaries</li></ul><p><strong>Creating Quality Specification Limits</strong></p><p>A tag does not exist for the upper and lower specification limit signals, so a signal had to be created.</p><p>1. Add the signal &#34;Grade_Code_with_Forecast&#34; back to the display pane. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43DD66CB-F12B-4EF0-8859-6A0055FBAD74\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>2. Create a Condition for each Product Grade using Value Search. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;E1EAD2A1-EEAB-4564-A56C-0CE7CC2C80EF\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>3. Use Formula and the Splice function to create a new signal for the upper and lower specification limits for Product Viscosity across all grades. Below is an example of how Formula is used to create these signals.\u00a0</p><pre>$USL101 &#61; (1.1).tosignal()\n$USL102 &#61; (0.88).tosignal()\n$USL103 &#61; (1.21).tosignal()\n$USL104 &#61; (0.825).tosignal()\n$USL105 &#61; (0.99).tosignal()\n$USL106 &#61; (0.594).tosignal()\n$USL107 &#61; (1.155).tosignal()\n$USL108 &#61; (1.87).tosignal()\n\n$USL101\n\u00a0 \u00a0 \u00a0.splice($USL102,$GR102,False)\n\u00a0 \u00a0 \u00a0.splice($USL103,$GR103, False)\n\u00a0 \u00a0 \u00a0.splice($USL104,$GR104, False)\n\u00a0 \u00a0 \u00a0.splice($USL105,$GR105, False)\n\u00a0 \u00a0 \u00a0.splice($USL106,$GR106, False)\n\u00a0 \u00a0 \u00a0.splice($USL107,$GR107, False)\n\u00a0 \u00a0 \u00a0.splice($USL108,$GR108, False)</pre><ul><li>Upper Specification Limit \u00a0(<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;22CA211F-A984-48D2-8204-214C65AFAEEE\" rel=\"nofollow noopener noreferrer\">work step</a>)</li><li>Lower Specification Limit (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;E9AE7BBF-1E85-45D1-B34E-883B518BB4C2\" rel=\"nofollow noopener noreferrer\">work step</a>)</li></ul><p>4. Use the Boundaries tool to turn the USL and LSL into boundaries on the signal &#34;Product_Viscosity&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;CCC50DD3-56F4-4090-AAA2-78CC409DDDA2\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>5. Create a signal for the Target Viscosity (Central between the USL and LSL). This can be done via the same splice methodology in formula, or by taking the average of the USL and LSL signals. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;9ABC586F-260A-4C8D-AB3C-672D0389634A\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.add($USL).divide(2)</pre><p><strong>Creating Boundaries during Grade Transitions</strong></p><p>We want to expand our upper and lower boundaries on the viscosity signal horizontally to encapsulate time periods when we are transitioning between product grades. To create a condition for &#34;Grade Transition&#34;:</p><p>1. Use formula to create a new combined condition for all grades that also assigns the value of the signal grade code to a property of the signal called &#34;Value&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;987DB510-DB3F-4251-B427-70D58904D407\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$gradeCode.tostring().toCapsules(1wk)</pre><p><em>Add the property &#34;value&#34; to the capsules pane to view the grade of each of the new capsules.\u00a0</em>\u00a0</p><p>2. Use formula and the afterstart() and move functions to create a new condition called &#34;Grade Transitions&#34; that includes 0.5 hours before the start of the &#34;All Grades (with Property)&#34; capsules and 2.5 hours following the start of each of the &#34;All Grades (with Property)&#34; capsules. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3230407F-812D-48B4-9237-69911398BF7A\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$allGrades.afterStart(3h).move(-0.5h)</pre><p>2. Calculate the maximum and minimum limits to be applied to create boundaries during the &#34;grade transition&#34; capsules. The following code takes the minimum of the LSL signal during the condition &#34;Transition&#34; and creates a new signal with that value over the duration of the condition. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;17A25070-8FD3-47CE-8B56-F5B6527B7F6A\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.aggregate(minvalue(),$Transition,durationkey())</pre><p>3. Use the Boundaries tool to create a new boundary on the Product_Viscosity signal over the condition &#34;Grade Transition Capsules.&#34; (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;BC42F345-900D-442F-AE10-DB1945ABC2D4\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;436EA481-A374-401F-BD30-8812A12059ED\" rel=\"nofollow noopener noreferrer\">Display Final View</a></h4>",
        "DocumentBackup\u02c9allison.buenemann@seeq.com\u02c92019-06-17T20:33:00Z": "<h4>Links to Previous Worksheets:</h4><ul><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/17065A04-0E4E-4A0F-AAC4-BC78F3269FEF\" rel=\"nofollow noopener noreferrer\">Pulling in Process Data</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/E730749E-353A-4D99-9CEF-3E0AFB9D6981\" rel=\"nofollow noopener noreferrer\">Calculating new Delayed Reactor Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/BDE8A3B9-866D-4D5B-8740-D10350D4924A\" rel=\"nofollow noopener noreferrer\">Cleansing Model Input Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/271B44F1-6AFB-4E54-9700-25E1577FCDDA\" rel=\"nofollow noopener noreferrer\">Model Generation and Comparison</a></li></ul><h3><strong>Creating Boundaries:</strong></h3><p>This worksheet uses Seeq tools to calculate and display product specification limits for the Product Viscosity as boundaries.</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;2D63C4D9-1D91-47FD-AED3-552A2A16B70E\" rel=\"nofollow noopener noreferrer\">Display Starting Point</a></h4><p><strong>Boundary Signals to be created:</strong></p><ul><li>Viscosity Quality Specification Limits</li><li>Grade Transition Condition Boundaries</li></ul><p><strong>Creating Quality Specification Limits</strong></p><p>A tag does not exist for the upper and lower specification limit signals, so a signal had to be created.</p><p>1. Add the signal &#34;Grade_Code_with_Forecast&#34; back to the display pane. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43DD66CB-F12B-4EF0-8859-6A0055FBAD74\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>2. Create a Condition for each Product Grade using Value Search. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3C5392D8-6D5C-4E34-8BF1-CFBD50671912\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>3. Use Formula and the Splice function to create a new signal for the upper and lower specification limits for Product Viscosity across all grades. Below is an example of how Formula is used to create these signals.\u00a0</p><pre>$USL101 &#61; (1.1).tosignal()\n$USL102 &#61; (0.88).tosignal()\n$USL103 &#61; (1.21).tosignal()\n$USL104 &#61; (0.825).tosignal()\n$USL105 &#61; (0.99).tosignal()\n$USL106 &#61; (0.594).tosignal()\n$USL107 &#61; (1.155).tosignal()\n$USL108 &#61; (1.87).tosignal()\n\n$USL101\n\u00a0 \u00a0 \u00a0.splice($USL102,$GR102,False)\n\u00a0 \u00a0 \u00a0.splice($USL103,$GR103, False)\n\u00a0 \u00a0 \u00a0.splice($USL104,$GR104, False)\n\u00a0 \u00a0 \u00a0.splice($USL105,$GR105, False)\n\u00a0 \u00a0 \u00a0.splice($USL106,$GR106, False)\n\u00a0 \u00a0 \u00a0.splice($USL107,$GR107, False)\n\u00a0 \u00a0 \u00a0.splice($USL108,$GR108, False)</pre><ul><li>Upper Specification Limit \u00a0(<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;22CA211F-A984-48D2-8204-214C65AFAEEE\" rel=\"nofollow noopener noreferrer\">work step</a>)</li><li>Lower Specification Limit (work step)</li></ul><p>4. Use the Boundaries tool to turn the USL and LSL into boundaries on the signal &#34;Product_Viscosity&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;CCC50DD3-56F4-4090-AAA2-78CC409DDDA2\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>5. Create a signal for the Target Viscosity (Central between the USL and LSL). This can be done via the same splice methodology in formula, or by taking the average of the USL and LSL signals. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;9ABC586F-260A-4C8D-AB3C-672D0389634A\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.add($USL).divide(2)</pre><p><strong>Creating Boundaries during Grade Transitions</strong></p><p>We want to expand our upper and lower boundaries on the viscosity signal horizontally to encapsulate time periods when we are transitioning between product grades. To create a condition for &#34;Grade Transition&#34;:</p><p>1. Use formula to create a new combined condition for all grades that also assigns the value of the signal grade code to a property of the signal called &#34;Value&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;987DB510-DB3F-4251-B427-70D58904D407\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$gradeCode.tostring().toCapsules(1wk)</pre><p><em>Add the property &#34;value&#34; to the capsules pane to view the grade of each of the new capsules.\u00a0</em>\u00a0</p><p>2. Use formula and the afterstart() and move functions to create a new condition called &#34;Grade Transitions&#34; that includes 0.5 hours before the start of the &#34;All Grades (with Property)&#34; capsules and 2.5 hours following the start of each of the &#34;All Grades (with Property)&#34; capsules. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3230407F-812D-48B4-9237-69911398BF7A\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$allGrades.afterStart(3h).move(-0.5h)</pre><p>2. Calculate the maximum and minimum limits to be applied to create boundaries during the &#34;grade transition&#34; capsules. The following code takes the minimum of the LSL signal during the condition &#34;Transition&#34; and creates a new signal with that value over the duration of the condition. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;17A25070-8FD3-47CE-8B56-F5B6527B7F6A\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.aggregate(minvalue(),$Transition,durationkey())</pre><p>3. Use the Boundaries tool to create a new boundary on the Product_Viscosity signal over the condition &#34;Grade Transition Capsules.&#34; (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;BC42F345-900D-442F-AE10-DB1945ABC2D4\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;436EA481-A374-401F-BD30-8812A12059ED\" rel=\"nofollow noopener noreferrer\">Display Final View</a></h4>",
        "DocumentBackup\u02c9allison.buenemann@seeq.com\u02c92019-06-17T20:34:00Z": "<h4>Links to Previous Worksheets:</h4><ul><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/17065A04-0E4E-4A0F-AAC4-BC78F3269FEF\" rel=\"nofollow noopener noreferrer\">Pulling in Process Data</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/E730749E-353A-4D99-9CEF-3E0AFB9D6981\" rel=\"nofollow noopener noreferrer\">Calculating new Delayed Reactor Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/BDE8A3B9-866D-4D5B-8740-D10350D4924A\" rel=\"nofollow noopener noreferrer\">Cleansing Model Input Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/271B44F1-6AFB-4E54-9700-25E1577FCDDA\" rel=\"nofollow noopener noreferrer\">Model Generation and Comparison</a></li></ul><h3><strong>Creating Boundaries:</strong></h3><p>This worksheet uses Seeq tools to calculate and display product specification limits for the Product Viscosity as boundaries.</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;2D63C4D9-1D91-47FD-AED3-552A2A16B70E\" rel=\"nofollow noopener noreferrer\">Display Starting Point</a></h4><p><strong>Boundary Signals to be created:</strong></p><ul><li>Viscosity Quality Specification Limits</li><li>Grade Transition Condition Boundaries</li></ul><p><strong>Creating Quality Specification Limits</strong></p><p>A tag does not exist for the upper and lower specification limit signals, so a signal had to be created.</p><p>1. Add the signal &#34;Grade_Code_with_Forecast&#34; back to the display pane. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43DD66CB-F12B-4EF0-8859-6A0055FBAD74\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>2. Create a Condition for each Product Grade using Value Search. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3C5392D8-6D5C-4E34-8BF1-CFBD50671912\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>3. Use Formula and the Splice function to create a new signal for the upper and lower specification limits for Product Viscosity across all grades. Below is an example of how Formula is used to create these signals.\u00a0</p><pre>$USL101 &#61; (1.1).tosignal()\n$USL102 &#61; (0.88).tosignal()\n$USL103 &#61; (1.21).tosignal()\n$USL104 &#61; (0.825).tosignal()\n$USL105 &#61; (0.99).tosignal()\n$USL106 &#61; (0.594).tosignal()\n$USL107 &#61; (1.155).tosignal()\n$USL108 &#61; (1.87).tosignal()\n\n$USL101\n\u00a0 \u00a0 \u00a0.splice($USL102,$GR102,False)\n\u00a0 \u00a0 \u00a0.splice($USL103,$GR103, False)\n\u00a0 \u00a0 \u00a0.splice($USL104,$GR104, False)\n\u00a0 \u00a0 \u00a0.splice($USL105,$GR105, False)\n\u00a0 \u00a0 \u00a0.splice($USL106,$GR106, False)\n\u00a0 \u00a0 \u00a0.splice($USL107,$GR107, False)\n\u00a0 \u00a0 \u00a0.splice($USL108,$GR108, False)</pre><ul><li>Upper Specification Limit \u00a0(<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;22CA211F-A984-48D2-8204-214C65AFAEEE\" rel=\"nofollow noopener noreferrer\">work step</a>)</li><li>Lower Specification Limit (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;D0E0F9F6-7727-4F0A-B5AE-21A29E517798\" rel=\"nofollow noopener noreferrer\">work step</a>)</li></ul><p>4. Use the Boundaries tool to turn the USL and LSL into boundaries on the signal &#34;Product_Viscosity&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;CCC50DD3-56F4-4090-AAA2-78CC409DDDA2\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>5. Create a signal for the Target Viscosity (Central between the USL and LSL). This can be done via the same splice methodology in formula, or by taking the average of the USL and LSL signals. (work step)</p><pre>$LSL.add($USL).divide(2)</pre><p><strong>Creating Boundaries during Grade Transitions</strong></p><p>We want to expand our upper and lower boundaries on the viscosity signal horizontally to encapsulate time periods when we are transitioning between product grades. To create a condition for &#34;Grade Transition&#34;:</p><p>1. Use formula to create a new combined condition for all grades that also assigns the value of the signal grade code to a property of the signal called &#34;Value&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;987DB510-DB3F-4251-B427-70D58904D407\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$gradeCode.tostring().toCapsules(1wk)</pre><p><em>Add the property &#34;value&#34; to the capsules pane to view the grade of each of the new capsules.\u00a0</em>\u00a0</p><p>2. Use formula and the afterstart() and move functions to create a new condition called &#34;Grade Transitions&#34; that includes 0.5 hours before the start of the &#34;All Grades (with Property)&#34; capsules and 2.5 hours following the start of each of the &#34;All Grades (with Property)&#34; capsules. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3230407F-812D-48B4-9237-69911398BF7A\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$allGrades.afterStart(3h).move(-0.5h)</pre><p>2. Calculate the maximum and minimum limits to be applied to create boundaries during the &#34;grade transition&#34; capsules. The following code takes the minimum of the LSL signal during the condition &#34;Transition&#34; and creates a new signal with that value over the duration of the condition. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;17A25070-8FD3-47CE-8B56-F5B6527B7F6A\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.aggregate(minvalue(),$Transition,durationkey())</pre><p>3. Use the Boundaries tool to create a new boundary on the Product_Viscosity signal over the condition &#34;Grade Transition Capsules.&#34; (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;BC42F345-900D-442F-AE10-DB1945ABC2D4\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;436EA481-A374-401F-BD30-8812A12059ED\" rel=\"nofollow noopener noreferrer\">Display Final View</a></h4>",
        "DocumentBackup\u02c9allison.buenemann@seeq.com\u02c92019-06-17T20:35:00Z": "<h4>Links to Previous Worksheets:</h4><ul><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/17065A04-0E4E-4A0F-AAC4-BC78F3269FEF\" rel=\"nofollow noopener noreferrer\">Pulling in Process Data</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/E730749E-353A-4D99-9CEF-3E0AFB9D6981\" rel=\"nofollow noopener noreferrer\">Calculating new Delayed Reactor Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/BDE8A3B9-866D-4D5B-8740-D10350D4924A\" rel=\"nofollow noopener noreferrer\">Cleansing Model Input Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/271B44F1-6AFB-4E54-9700-25E1577FCDDA\" rel=\"nofollow noopener noreferrer\">Model Generation and Comparison</a></li></ul><h3><strong>Creating Boundaries:</strong></h3><p>This worksheet uses Seeq tools to calculate and display product specification limits for the Product Viscosity as boundaries.</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;2D63C4D9-1D91-47FD-AED3-552A2A16B70E\" rel=\"nofollow noopener noreferrer\">Display Starting Point</a></h4><p><strong>Boundary Signals to be created:</strong></p><ul><li>Viscosity Quality Specification Limits</li><li>Grade Transition Condition Boundaries</li></ul><p><strong>Creating Quality Specification Limits</strong></p><p>A tag does not exist for the upper and lower specification limit signals, so a signal had to be created.</p><p>1. Add the signal &#34;Grade_Code_with_Forecast&#34; back to the display pane. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43DD66CB-F12B-4EF0-8859-6A0055FBAD74\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>2. Create a Condition for each Product Grade using Value Search. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3C5392D8-6D5C-4E34-8BF1-CFBD50671912\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>3. Use Formula and the Splice function to create a new signal for the upper and lower specification limits for Product Viscosity across all grades. Below is an example of how Formula is used to create these signals.\u00a0</p><pre>$USL101 &#61; (1.1).tosignal()\n$USL102 &#61; (0.88).tosignal()\n$USL103 &#61; (1.21).tosignal()\n$USL104 &#61; (0.825).tosignal()\n$USL105 &#61; (0.99).tosignal()\n$USL106 &#61; (0.594).tosignal()\n$USL107 &#61; (1.155).tosignal()\n$USL108 &#61; (1.87).tosignal()\n\n$USL101\n\u00a0 \u00a0 \u00a0.splice($USL102,$GR102,False)\n\u00a0 \u00a0 \u00a0.splice($USL103,$GR103, False)\n\u00a0 \u00a0 \u00a0.splice($USL104,$GR104, False)\n\u00a0 \u00a0 \u00a0.splice($USL105,$GR105, False)\n\u00a0 \u00a0 \u00a0.splice($USL106,$GR106, False)\n\u00a0 \u00a0 \u00a0.splice($USL107,$GR107, False)\n\u00a0 \u00a0 \u00a0.splice($USL108,$GR108, False)</pre><ul><li>Upper Specification Limit \u00a0(<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;22CA211F-A984-48D2-8204-214C65AFAEEE\" rel=\"nofollow noopener noreferrer\">work step</a>)</li><li>Lower Specification Limit (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;D0E0F9F6-7727-4F0A-B5AE-21A29E517798\" rel=\"nofollow noopener noreferrer\">work step</a>)</li></ul><p>4. Use the Boundaries tool to turn the USL and LSL into boundaries on the signal &#34;Product_Viscosity&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;EE4C97C8-3C1D-4B65-9C03-999F262028B1\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>5. Create a signal for the Target Viscosity (Central between the USL and LSL). This can be done via the same splice methodology in formula, or by taking the average of the USL and LSL signals. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C3B29D21-FAD2-4EF3-9DC3-6FF080FFB33C\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.add($USL).divide(2)</pre><p><strong>Creating Boundaries during Grade Transitions</strong></p><p>We want to expand our upper and lower boundaries on the viscosity signal horizontally to encapsulate time periods when we are transitioning between product grades. To create a condition for &#34;Grade Transition&#34;:</p><p>1. Use formula to create a new combined condition for all grades that also assigns the value of the signal grade code to a property of the signal called &#34;Value&#34;. (work step)</p><pre>$gradeCode.tostring().toCapsules(1wk)</pre><p><em>Add the property &#34;value&#34; to the capsules pane to view the grade of each of the new capsules.\u00a0</em>\u00a0</p><p>2. Use formula and the afterstart() and move functions to create a new condition called &#34;Grade Transitions&#34; that includes 0.5 hours before the start of the &#34;All Grades (with Property)&#34; capsules and 2.5 hours following the start of each of the &#34;All Grades (with Property)&#34; capsules. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3230407F-812D-48B4-9237-69911398BF7A\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$allGrades.afterStart(3h).move(-0.5h)</pre><p>2. Calculate the maximum and minimum limits to be applied to create boundaries during the &#34;grade transition&#34; capsules. The following code takes the minimum of the LSL signal during the condition &#34;Transition&#34; and creates a new signal with that value over the duration of the condition. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;17A25070-8FD3-47CE-8B56-F5B6527B7F6A\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.aggregate(minvalue(),$Transition,durationkey())</pre><p>3. Use the Boundaries tool to create a new boundary on the Product_Viscosity signal over the condition &#34;Grade Transition Capsules.&#34; (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;BC42F345-900D-442F-AE10-DB1945ABC2D4\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;436EA481-A374-401F-BD30-8812A12059ED\" rel=\"nofollow noopener noreferrer\">Display Final View</a></h4>",
        "DocumentBackup\u02c9allison.buenemann@seeq.com\u02c92019-06-17T20:36:00Z": "<h4>Links to Previous Worksheets:</h4><ul><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/17065A04-0E4E-4A0F-AAC4-BC78F3269FEF\" rel=\"nofollow noopener noreferrer\">Pulling in Process Data</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/E730749E-353A-4D99-9CEF-3E0AFB9D6981\" rel=\"nofollow noopener noreferrer\">Calculating new Delayed Reactor Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/BDE8A3B9-866D-4D5B-8740-D10350D4924A\" rel=\"nofollow noopener noreferrer\">Cleansing Model Input Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/271B44F1-6AFB-4E54-9700-25E1577FCDDA\" rel=\"nofollow noopener noreferrer\">Model Generation and Comparison</a></li></ul><h3><strong>Creating Boundaries:</strong></h3><p>This worksheet uses Seeq tools to calculate and display product specification limits for the Product Viscosity as boundaries.</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;2D63C4D9-1D91-47FD-AED3-552A2A16B70E\" rel=\"nofollow noopener noreferrer\">Display Starting Point</a></h4><p><strong>Boundary Signals to be created:</strong></p><ul><li>Viscosity Quality Specification Limits</li><li>Grade Transition Condition Boundaries</li></ul><p><strong>Creating Quality Specification Limits</strong></p><p>A tag does not exist for the upper and lower specification limit signals, so a signal had to be created.</p><p>1. Add the signal &#34;Grade_Code_with_Forecast&#34; back to the display pane. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43DD66CB-F12B-4EF0-8859-6A0055FBAD74\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>2. Create a Condition for each Product Grade using Value Search. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3C5392D8-6D5C-4E34-8BF1-CFBD50671912\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>3. Use Formula and the Splice function to create a new signal for the upper and lower specification limits for Product Viscosity across all grades. Below is an example of how Formula is used to create these signals.\u00a0</p><pre>$USL101 &#61; (1.1).tosignal()\n$USL102 &#61; (0.88).tosignal()\n$USL103 &#61; (1.21).tosignal()\n$USL104 &#61; (0.825).tosignal()\n$USL105 &#61; (0.99).tosignal()\n$USL106 &#61; (0.594).tosignal()\n$USL107 &#61; (1.155).tosignal()\n$USL108 &#61; (1.87).tosignal()\n\n$USL101\n\u00a0 \u00a0 \u00a0.splice($USL102,$GR102,False)\n\u00a0 \u00a0 \u00a0.splice($USL103,$GR103, False)\n\u00a0 \u00a0 \u00a0.splice($USL104,$GR104, False)\n\u00a0 \u00a0 \u00a0.splice($USL105,$GR105, False)\n\u00a0 \u00a0 \u00a0.splice($USL106,$GR106, False)\n\u00a0 \u00a0 \u00a0.splice($USL107,$GR107, False)\n\u00a0 \u00a0 \u00a0.splice($USL108,$GR108, False)</pre><ul><li>Upper Specification Limit \u00a0(<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;22CA211F-A984-48D2-8204-214C65AFAEEE\" rel=\"nofollow noopener noreferrer\">work step</a>)</li><li>Lower Specification Limit (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;D0E0F9F6-7727-4F0A-B5AE-21A29E517798\" rel=\"nofollow noopener noreferrer\">work step</a>)</li></ul><p>4. Use the Boundaries tool to turn the USL and LSL into boundaries on the signal &#34;Product_Viscosity&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;EE4C97C8-3C1D-4B65-9C03-999F262028B1\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>5. Create a signal for the Target Viscosity (Central between the USL and LSL). This can be done via the same splice methodology in formula, or by taking the average of the USL and LSL signals. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C3B29D21-FAD2-4EF3-9DC3-6FF080FFB33C\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.add($USL).divide(2)</pre><p><strong>Creating Boundaries during Grade Transitions</strong></p><p>We want to expand our upper and lower boundaries on the viscosity signal horizontally to encapsulate time periods when we are transitioning between product grades. To create a condition for &#34;Grade Transition&#34;:</p><p>1. Use formula to create a new combined condition for all grades that also assigns the value of the signal grade code to a property of the signal called &#34;Value&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43D6561B-E8EA-4E20-80C6-F375D49A0647\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$gradeCode.tostring().toCapsules(1wk)</pre><p><em>Add the property &#34;value&#34; to the capsules pane to view the grade of each of the new capsules.\u00a0</em>\u00a0</p><p>2. Use formula and the afterstart() and move functions to create a new condition called &#34;Grade Transitions&#34; that includes 0.5 hours before the start of the &#34;All Grades (with Property)&#34; capsules and 2.5 hours following the start of each of the &#34;All Grades (with Property)&#34; capsules. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3230407F-812D-48B4-9237-69911398BF7A\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$allGrades.afterStart(3h).move(-0.5h)</pre><p>2. Calculate the maximum and minimum limits to be applied to create boundaries during the &#34;grade transition&#34; capsules. The following code takes the minimum of the LSL signal during the condition &#34;Transition&#34; and creates a new signal with that value over the duration of the condition. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;17A25070-8FD3-47CE-8B56-F5B6527B7F6A\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.aggregate(minvalue(),$Transition,durationkey())</pre><p>3. Use the Boundaries tool to create a new boundary on the Product_Viscosity signal over the condition &#34;Grade Transition Capsules.&#34; (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;BC42F345-900D-442F-AE10-DB1945ABC2D4\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;436EA481-A374-401F-BD30-8812A12059ED\" rel=\"nofollow noopener noreferrer\">Display Final View</a></h4>",
        "DocumentBackup\u02c9allison.buenemann@seeq.com\u02c92019-06-17T20:37:00Z": "<h4>Links to Previous Worksheets:</h4><ul><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/17065A04-0E4E-4A0F-AAC4-BC78F3269FEF\" rel=\"nofollow noopener noreferrer\">Pulling in Process Data</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/E730749E-353A-4D99-9CEF-3E0AFB9D6981\" rel=\"nofollow noopener noreferrer\">Calculating new Delayed Reactor Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/BDE8A3B9-866D-4D5B-8740-D10350D4924A\" rel=\"nofollow noopener noreferrer\">Cleansing Model Input Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/271B44F1-6AFB-4E54-9700-25E1577FCDDA\" rel=\"nofollow noopener noreferrer\">Model Generation and Comparison</a></li></ul><h3><strong>Creating Boundaries:</strong></h3><p>This worksheet uses Seeq tools to calculate and display product specification limits for the Product Viscosity as boundaries.</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;2D63C4D9-1D91-47FD-AED3-552A2A16B70E\" rel=\"nofollow noopener noreferrer\">Display Starting Point</a></h4><p><strong>Boundary Signals to be created:</strong></p><ul><li>Viscosity Quality Specification Limits</li><li>Grade Transition Condition Boundaries</li></ul><p><strong>Creating Quality Specification Limits</strong></p><p>A tag does not exist for the upper and lower specification limit signals, so a signal had to be created.</p><p>1. Add the signal &#34;Grade_Code_with_Forecast&#34; back to the display pane. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43DD66CB-F12B-4EF0-8859-6A0055FBAD74\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>2. Create a Condition for each Product Grade using Value Search. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3C5392D8-6D5C-4E34-8BF1-CFBD50671912\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>3. Use Formula and the Splice function to create a new signal for the upper and lower specification limits for Product Viscosity across all grades. Below is an example of how Formula is used to create these signals.\u00a0</p><pre>$USL101 &#61; (1.1).tosignal()\n$USL102 &#61; (0.88).tosignal()\n$USL103 &#61; (1.21).tosignal()\n$USL104 &#61; (0.825).tosignal()\n$USL105 &#61; (0.99).tosignal()\n$USL106 &#61; (0.594).tosignal()\n$USL107 &#61; (1.155).tosignal()\n$USL108 &#61; (1.87).tosignal()\n\n$USL101\n\u00a0 \u00a0 \u00a0.splice($USL102,$GR102,False)\n\u00a0 \u00a0 \u00a0.splice($USL103,$GR103, False)\n\u00a0 \u00a0 \u00a0.splice($USL104,$GR104, False)\n\u00a0 \u00a0 \u00a0.splice($USL105,$GR105, False)\n\u00a0 \u00a0 \u00a0.splice($USL106,$GR106, False)\n\u00a0 \u00a0 \u00a0.splice($USL107,$GR107, False)\n\u00a0 \u00a0 \u00a0.splice($USL108,$GR108, False)</pre><ul><li>Upper Specification Limit \u00a0(<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;22CA211F-A984-48D2-8204-214C65AFAEEE\" rel=\"nofollow noopener noreferrer\">work step</a>)</li><li>Lower Specification Limit (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;D0E0F9F6-7727-4F0A-B5AE-21A29E517798\" rel=\"nofollow noopener noreferrer\">work step</a>)</li></ul><p>4. Use the Boundaries tool to turn the USL and LSL into boundaries on the signal &#34;Product_Viscosity&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;EE4C97C8-3C1D-4B65-9C03-999F262028B1\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>5. Create a signal for the Target Viscosity (Central between the USL and LSL). This can be done via the same splice methodology in formula, or by taking the average of the USL and LSL signals. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C3B29D21-FAD2-4EF3-9DC3-6FF080FFB33C\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.add($USL).divide(2)</pre><p><strong>Creating Boundaries during Grade Transitions</strong></p><p>We want to expand our upper and lower boundaries on the viscosity signal horizontally to encapsulate time periods when we are transitioning between product grades. To create a condition for &#34;Grade Transition&#34;:</p><p>1. Use formula to create a new combined condition for all grades that also assigns the value of the signal grade code to a property of the signal called &#34;Value&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43D6561B-E8EA-4E20-80C6-F375D49A0647\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$gradeCode.tostring().toCapsules(1wk)</pre><p><em>Add the property &#34;value&#34; to the capsules pane to view the grade of each of the new capsules.\u00a0</em>\u00a0</p><p>2. Use formula and the afterstart() and move functions to create a new condition called &#34;Grade Transitions&#34; that includes 0.5 hours before the start of the &#34;All Grades (with Property)&#34; capsules and 2.5 hours following the start of each of the &#34;All Grades (with Property)&#34; capsules. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3E0880B4-6A08-4BF2-B1C5-890EEB133B92\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$allGrades.afterStart(3h).move(-0.5h)</pre><p>2. Calculate the maximum and minimum limits to be applied to create boundaries during the &#34;grade transition&#34; capsules. The following code takes the minimum of the LSL signal during the condition &#34;Transition&#34; and creates a new signal with that value over the duration of the condition. (work step)</p><pre>$LSL.aggregate(minvalue(),$Transition,durationkey())</pre><p>3. Use the Boundaries tool to create a new boundary on the Product_Viscosity signal over the condition &#34;Grade Transition Capsules.&#34; (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;BC42F345-900D-442F-AE10-DB1945ABC2D4\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;436EA481-A374-401F-BD30-8812A12059ED\" rel=\"nofollow noopener noreferrer\">Display Final View</a></h4>",
        "DocumentBackup\u02c9allison.buenemann@seeq.com\u02c92019-06-17T20:38:00Z": "<h4>Links to Previous Worksheets:</h4><ul><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/17065A04-0E4E-4A0F-AAC4-BC78F3269FEF\" rel=\"nofollow noopener noreferrer\">Pulling in Process Data</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/E730749E-353A-4D99-9CEF-3E0AFB9D6981\" rel=\"nofollow noopener noreferrer\">Calculating new Delayed Reactor Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/BDE8A3B9-866D-4D5B-8740-D10350D4924A\" rel=\"nofollow noopener noreferrer\">Cleansing Model Input Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/271B44F1-6AFB-4E54-9700-25E1577FCDDA\" rel=\"nofollow noopener noreferrer\">Model Generation and Comparison</a></li></ul><h3><strong>Creating Boundaries:</strong></h3><p>This worksheet uses Seeq tools to calculate and display product specification limits for the Product Viscosity as boundaries.</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;2D63C4D9-1D91-47FD-AED3-552A2A16B70E\" rel=\"nofollow noopener noreferrer\">Display Starting Point</a></h4><p><strong>Boundary Signals to be created:</strong></p><ul><li>Viscosity Quality Specification Limits</li><li>Grade Transition Condition Boundaries</li></ul><p><strong>Creating Quality Specification Limits</strong></p><p>A tag does not exist for the upper and lower specification limit signals, so a signal had to be created.</p><p>1. Add the signal &#34;Grade_Code_with_Forecast&#34; back to the display pane. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43DD66CB-F12B-4EF0-8859-6A0055FBAD74\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>2. Create a Condition for each Product Grade using Value Search. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3C5392D8-6D5C-4E34-8BF1-CFBD50671912\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>3. Use Formula and the Splice function to create a new signal for the upper and lower specification limits for Product Viscosity across all grades. Below is an example of how Formula is used to create these signals.\u00a0</p><pre>$USL101 &#61; (1.1).tosignal()\n$USL102 &#61; (0.88).tosignal()\n$USL103 &#61; (1.21).tosignal()\n$USL104 &#61; (0.825).tosignal()\n$USL105 &#61; (0.99).tosignal()\n$USL106 &#61; (0.594).tosignal()\n$USL107 &#61; (1.155).tosignal()\n$USL108 &#61; (1.87).tosignal()\n\n$USL101\n\u00a0 \u00a0 \u00a0.splice($USL102,$GR102,False)\n\u00a0 \u00a0 \u00a0.splice($USL103,$GR103, False)\n\u00a0 \u00a0 \u00a0.splice($USL104,$GR104, False)\n\u00a0 \u00a0 \u00a0.splice($USL105,$GR105, False)\n\u00a0 \u00a0 \u00a0.splice($USL106,$GR106, False)\n\u00a0 \u00a0 \u00a0.splice($USL107,$GR107, False)\n\u00a0 \u00a0 \u00a0.splice($USL108,$GR108, False)</pre><ul><li>Upper Specification Limit \u00a0(<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;22CA211F-A984-48D2-8204-214C65AFAEEE\" rel=\"nofollow noopener noreferrer\">work step</a>)</li><li>Lower Specification Limit (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;D0E0F9F6-7727-4F0A-B5AE-21A29E517798\" rel=\"nofollow noopener noreferrer\">work step</a>)</li></ul><p>4. Use the Boundaries tool to turn the USL and LSL into boundaries on the signal &#34;Product_Viscosity&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;EE4C97C8-3C1D-4B65-9C03-999F262028B1\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>5. Create a signal for the Target Viscosity (Central between the USL and LSL). This can be done via the same splice methodology in formula, or by taking the average of the USL and LSL signals. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C3B29D21-FAD2-4EF3-9DC3-6FF080FFB33C\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.add($USL).divide(2)</pre><p><strong>Creating Boundaries during Grade Transitions</strong></p><p>We want to expand our upper and lower boundaries on the viscosity signal horizontally to encapsulate time periods when we are transitioning between product grades. To create a condition for &#34;Grade Transition&#34;:</p><p>1. Use formula to create a new combined condition for all grades that also assigns the value of the signal grade code to a property of the signal called &#34;Value&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43D6561B-E8EA-4E20-80C6-F375D49A0647\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$gradeCode.tostring().toCapsules(1wk)</pre><p><em>Add the property &#34;value&#34; to the capsules pane to view the grade of each of the new capsules.\u00a0</em>\u00a0</p><p>2. Use formula and the afterstart() and move functions to create a new condition called &#34;Grade Transitions&#34; that includes 0.5 hours before the start of the &#34;All Grades (with Property)&#34; capsules and 2.5 hours following the start of each of the &#34;All Grades (with Property)&#34; capsules. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3E0880B4-6A08-4BF2-B1C5-890EEB133B92\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$allGrades.afterStart(3h).move(-0.5h)</pre><p>2. Calculate the maximum and minimum limits to be applied to create boundaries during the &#34;grade transition&#34; capsules. The following code takes the minimum of the LSL signal during the condition &#34;Transition&#34; and creates a new signal with that value over the duration of the condition. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C69B22AC-61AA-4931-B7FD-6C6E73940BB6\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.aggregate(minvalue(),$Transition,durationkey())</pre><p>3. Use the Boundaries tool to create a new boundary on the Product_Viscosity signal over the condition &#34;Grade Transition Capsules.&#34; (work step)</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;436EA481-A374-401F-BD30-8812A12059ED\" rel=\"nofollow noopener noreferrer\">Display Final View</a></h4>",
        "DocumentBackup\u02c9allison.buenemann@seeq.com\u02c92019-06-17T20:39:00Z": "<h4>Links to Previous Worksheets:</h4><ul><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/17065A04-0E4E-4A0F-AAC4-BC78F3269FEF\" rel=\"nofollow noopener noreferrer\">Pulling in Process Data</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/E730749E-353A-4D99-9CEF-3E0AFB9D6981\" rel=\"nofollow noopener noreferrer\">Calculating new Delayed Reactor Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/BDE8A3B9-866D-4D5B-8740-D10350D4924A\" rel=\"nofollow noopener noreferrer\">Cleansing Model Input Signals</a></li><li><a href=\"https://explore.seeq.com/workbook/86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC/worksheet/271B44F1-6AFB-4E54-9700-25E1577FCDDA\" rel=\"nofollow noopener noreferrer\">Model Generation and Comparison</a></li></ul><h3><strong>Creating Boundaries:</strong></h3><p>This worksheet uses Seeq tools to calculate and display product specification limits for the Product Viscosity as boundaries.</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;2D63C4D9-1D91-47FD-AED3-552A2A16B70E\" rel=\"nofollow noopener noreferrer\">Display Starting Point</a></h4><p><strong>Boundary Signals to be created:</strong></p><ul><li>Viscosity Quality Specification Limits</li><li>Grade Transition Condition Boundaries</li></ul><p><strong>Creating Quality Specification Limits</strong></p><p>A tag does not exist for the upper and lower specification limit signals, so a signal had to be created.</p><p>1. Add the signal &#34;Grade_Code_with_Forecast&#34; back to the display pane. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43DD66CB-F12B-4EF0-8859-6A0055FBAD74\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>2. Create a Condition for each Product Grade using Value Search. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3C5392D8-6D5C-4E34-8BF1-CFBD50671912\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>3. Use Formula and the Splice function to create a new signal for the upper and lower specification limits for Product Viscosity across all grades. Below is an example of how Formula is used to create these signals.\u00a0</p><pre>$USL101 &#61; (1.1).tosignal()\n$USL102 &#61; (0.88).tosignal()\n$USL103 &#61; (1.21).tosignal()\n$USL104 &#61; (0.825).tosignal()\n$USL105 &#61; (0.99).tosignal()\n$USL106 &#61; (0.594).tosignal()\n$USL107 &#61; (1.155).tosignal()\n$USL108 &#61; (1.87).tosignal()\n\n$USL101\n\u00a0 \u00a0 \u00a0.splice($USL102,$GR102,False)\n\u00a0 \u00a0 \u00a0.splice($USL103,$GR103, False)\n\u00a0 \u00a0 \u00a0.splice($USL104,$GR104, False)\n\u00a0 \u00a0 \u00a0.splice($USL105,$GR105, False)\n\u00a0 \u00a0 \u00a0.splice($USL106,$GR106, False)\n\u00a0 \u00a0 \u00a0.splice($USL107,$GR107, False)\n\u00a0 \u00a0 \u00a0.splice($USL108,$GR108, False)</pre><ul><li>Upper Specification Limit \u00a0(<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;22CA211F-A984-48D2-8204-214C65AFAEEE\" rel=\"nofollow noopener noreferrer\">work step</a>)</li><li>Lower Specification Limit (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;D0E0F9F6-7727-4F0A-B5AE-21A29E517798\" rel=\"nofollow noopener noreferrer\">work step</a>)</li></ul><p>4. Use the Boundaries tool to turn the USL and LSL into boundaries on the signal &#34;Product_Viscosity&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;EE4C97C8-3C1D-4B65-9C03-999F262028B1\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>5. Create a signal for the Target Viscosity (Central between the USL and LSL). This can be done via the same splice methodology in formula, or by taking the average of the USL and LSL signals. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C3B29D21-FAD2-4EF3-9DC3-6FF080FFB33C\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.add($USL).divide(2)</pre><p><strong>Creating Boundaries during Grade Transitions</strong></p><p>We want to expand our upper and lower boundaries on the viscosity signal horizontally to encapsulate time periods when we are transitioning between product grades. To create a condition for &#34;Grade Transition&#34;:</p><p>1. Use formula to create a new combined condition for all grades that also assigns the value of the signal grade code to a property of the signal called &#34;Value&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43D6561B-E8EA-4E20-80C6-F375D49A0647\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$gradeCode.tostring().toCapsules(1wk)</pre><p><em>Add the property &#34;value&#34; to the capsules pane to view the grade of each of the new capsules.\u00a0</em>\u00a0</p><p>2. Use formula and the afterstart() and move functions to create a new condition called &#34;Grade Transitions&#34; that includes 0.5 hours before the start of the &#34;All Grades (with Property)&#34; capsules and 2.5 hours following the start of each of the &#34;All Grades (with Property)&#34; capsules. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3E0880B4-6A08-4BF2-B1C5-890EEB133B92\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$allGrades.afterStart(3h).move(-0.5h)</pre><p>2. Calculate the maximum and minimum limits to be applied to create boundaries during the &#34;grade transition&#34; capsules. The following code takes the minimum of the LSL signal during the condition &#34;Transition&#34; and creates a new signal with that value over the duration of the condition. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C69B22AC-61AA-4931-B7FD-6C6E73940BB6\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.aggregate(minvalue(),$Transition,durationkey())</pre><p>3. Use the Boundaries tool to create a new boundary on the Product_Viscosity signal over the condition &#34;Grade Transition Capsules.&#34; (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;90EBF834-6CDF-46FB-A600-7483E9F9996B\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><h4>Display Final View</h4>",
        "Enabled": true,
        "Froala Backup": "<h3><strong>Creating Boundaries:</strong></h3><p>This worksheet uses Seeq tools to calculate and display product specification limits for the Product Viscosity as boundaries.</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;2D63C4D9-1D91-47FD-AED3-552A2A16B70E\" rel=\"nofollow noopener noreferrer\">Display Starting Point</a></h4><p><strong>Boundary Signals to be created:</strong></p><ul><li>Viscosity Quality Specification Limits</li><li>Grade Transition Condition Boundaries</li></ul><p><strong>Creating Quality Specification Limits</strong></p><p>A tag does not exist for the upper and lower specification limit signals, so a signal had to be created.</p><p>1. Add the signal &#34;Grade_Code_with_Forecast&#34; back to the display pane. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43DD66CB-F12B-4EF0-8859-6A0055FBAD74\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>2. Create a Condition for each Product Grade using Value Search. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3C5392D8-6D5C-4E34-8BF1-CFBD50671912\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>3. Use Formula and the Splice function to create a new signal for the upper and lower specification limits for Product Viscosity across all grades. Below is an example of how Formula is used to create these signals.\u00a0</p><pre>$USL101 &#61; (1.1).tosignal()\n$USL102 &#61; (0.88).tosignal()\n$USL103 &#61; (1.21).tosignal()\n$USL104 &#61; (0.825).tosignal()\n$USL105 &#61; (0.99).tosignal()\n$USL106 &#61; (0.594).tosignal()\n$USL107 &#61; (1.155).tosignal()\n$USL108 &#61; (1.87).tosignal()\n\n$USL101\n\u00a0 \u00a0 \u00a0.splice($USL102,$GR102,False)\n\u00a0 \u00a0 \u00a0.splice($USL103,$GR103, False)\n\u00a0 \u00a0 \u00a0.splice($USL104,$GR104, False)\n\u00a0 \u00a0 \u00a0.splice($USL105,$GR105, False)\n\u00a0 \u00a0 \u00a0.splice($USL106,$GR106, False)\n\u00a0 \u00a0 \u00a0.splice($USL107,$GR107, False)\n\u00a0 \u00a0 \u00a0.splice($USL108,$GR108, False)</pre><ul><li>Upper Specification Limit \u00a0(<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;22CA211F-A984-48D2-8204-214C65AFAEEE\" rel=\"nofollow noopener noreferrer\">work step</a>)</li><li>Lower Specification Limit (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;D0E0F9F6-7727-4F0A-B5AE-21A29E517798\" rel=\"nofollow noopener noreferrer\">work step</a>)</li></ul><p>4. Use the Boundaries tool to turn the USL and LSL into boundaries on the signal &#34;Product_Viscosity&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;EE4C97C8-3C1D-4B65-9C03-999F262028B1\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><p>5. Create a signal for the Target Viscosity (Central between the USL and LSL). This can be done via the same splice methodology in formula, or by taking the average of the USL and LSL signals. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C3B29D21-FAD2-4EF3-9DC3-6FF080FFB33C\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.add($USL).divide(2)</pre><p><strong>Creating Boundaries during Grade Transitions</strong></p><p>We want to expand our upper and lower boundaries on the viscosity signal horizontally to encapsulate time periods when we are transitioning between product grades. To create a condition for &#34;Grade Transition&#34;:</p><p>1. Use formula to create a new combined condition for all grades that also assigns the value of the signal grade code to a property of the signal called &#34;Value&#34;. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;43D6561B-E8EA-4E20-80C6-F375D49A0647\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$gradeCode.tostring().toCapsules(1wk)</pre><p><em>Add the property &#34;value&#34; to the capsules pane to view the grade of each of the new capsules.\u00a0</em>\u00a0</p><p>2. Use formula and the afterstart() and move functions to create a new condition called &#34;Grade Transitions&#34; that includes 0.5 hours before the start of the &#34;All Grades (with Property)&#34; capsules and 2.5 hours following the start of each of the &#34;All Grades (with Property)&#34; capsules. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;3E0880B4-6A08-4BF2-B1C5-890EEB133B92\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$allGrades.afterStart(3h).move(-0.5h)</pre><p>2. Calculate the maximum and minimum limits to be applied to create boundaries during the &#34;grade transition&#34; capsules. The following code takes the minimum of the LSL signal during the condition &#34;Transition&#34; and creates a new signal with that value over the duration of the condition. (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;C69B22AC-61AA-4931-B7FD-6C6E73940BB6\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><pre>$LSL.aggregate(minvalue(),$Transition,durationkey())</pre><p>3. Use the Boundaries tool to create a new boundary on the Product_Viscosity signal over the condition &#34;Grade Transition Capsules.&#34; (<a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;90EBF834-6CDF-46FB-A600-7483E9F9996B\" rel=\"nofollow noopener noreferrer\">work step</a>)</p><h4><a href=\"/links?type&#61;workstep&amp;workbook&#61;86BEA7EF-3A51-4BA0-8CDF-B3675E05EFFC&amp;worksheet&#61;985F5347-518A-4B75-84A4-551562FAE435&amp;workstep&#61;484049F3-AA2E-4E89-9D53-49AF4272A071\" rel=\"nofollow noopener noreferrer\">Display Final View</a></h4>",
        "ID": "BB297CCA-4FD9-4886-A841-725666247773",
        "Is CK Enabled": true,
        "Name": "Creating Boundaries:",
        "Plain Text Document": "Creating Boundaries:This worksheet uses Seeq tools to calculate and display product specification limits for the Product Viscosity as boundaries.Display Starting PointBoundary Signals to be created:Viscosity Quality Specification LimitsGrade Transition Condition BoundariesCreating Quality Specification LimitsA tag does not exist for the upper and lower specification limit signals, so a signal had to be created.1. Add the signal &#34;Grade_Code_with_Forecast&#34; back to the display pane. (work step)2. Create a Condition for each Product Grade using Value Search. (work step)3. Use Formula and the Splice function to create a new signal for the upper and lower specification limits for Product Viscosity across all grades. Below is an example of how Formula is used to create these signals.\u00a0$USL101 &#61; (1.1).tosignal()\n$USL102 &#61; (0.88).tosignal()\n$USL103 &#61; (1.21).tosignal()\n$USL104 &#61; (0.825).tosignal()\n$USL105 &#61; (0.99).tosignal()\n$USL106 &#61; (0.594).tosignal()\n$USL107 &#61; (1.155).tosignal()\n$USL108 &#61; (1.87).tosignal()\n\n$USL101\n\u00a0 \u00a0 \u00a0.splice($USL102,$GR102,False)\n\u00a0 \u00a0 \u00a0.splice($USL103,$GR103, False)\n\u00a0 \u00a0 \u00a0.splice($USL104,$GR104, False)\n\u00a0 \u00a0 \u00a0.splice($USL105,$GR105, False)\n\u00a0 \u00a0 \u00a0.splice($USL106,$GR106, False)\n\u00a0 \u00a0 \u00a0.splice($USL107,$GR107, False)\n\u00a0 \u00a0 \u00a0.splice($USL108,$GR108, False)Upper Specification Limit \u00a0(work step)Lower Specification Limit (work step)4. Use the Boundaries tool to turn the USL and LSL into boundaries on the signal &#34;Product_Viscosity&#34;. (work step)5. Create a signal for the Target Viscosity (Central between the USL and LSL). This can be done via the same splice methodology in formula, or by taking the average of the USL and LSL signals. (work step)$LSL.add($USL).divide(2)Creating Boundaries during Grade TransitionsWe want to expand our upper and lower boundaries on the viscosity signal horizontally to encapsulate time periods when we are transitioning between product grades. To create a condition for &#34;Grade Transition&#34;:1. Use formula to create a new combined condition for all grades that also assigns the value of the signal grade code to a property of the signal called &#34;Value&#34;. (work step)$gradeCode.tostring().toCapsules(1wk)Add the property &#34;value&#34; to the capsules pane to view the grade of each of the new capsules.\u00a0\u00a02. Use formula and the afterstart() and move functions to create a new condition called &#34;Grade Transitions&#34; that includes 0.5 hours before the start of the &#34;All Grades (with Property)&#34; capsules and 2.5 hours following the start of each of the &#34;All Grades (with Property)&#34; capsules. (work step)$allGrades.afterStart(3h).move(-0.5h)2. Calculate the maximum and minimum limits to be applied to create boundaries during the &#34;grade transition&#34; capsules. The following code takes the minimum of the LSL signal during the condition &#34;Transition&#34; and creates a new signal with that value over the duration of the condition. (work step)$LSL.aggregate(minvalue(),$Transition,durationkey())3. Use the Boundaries tool to create a new boundary on the Product_Viscosity signal over the condition &#34;Grade Transition Capsules.&#34; (work step)Display Final View",
        "Type": "Journal",
        "Unsearchable": false,
        "Updated At": "1635437988698972400"
    }
}